<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¨Ø±Ø¯ Ù†Ù‡Ø§ÛŒÛŒ: Ù…ÛŒØ±Ø²Ø§Ø²Ø§Ø¯Ù‡ vs Ø§ÛŒØ²Ø¯ÙØ±</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #111;
            font-family: 'Arial', sans-serif;
            cursor: crosshair;
            user-select: none;
        }
        #gameCanvas {
            display: block;
            margin: 20px auto;
            background-image: url('https://www.dropbox.com/scl/fi/ldjty5aao135r47ftng7w/images.jpg?rlkey=kzsu2tbho9xg7ki2jxzlc7tq4&st=0ztw1pk8&dl=1');
            background-size: cover;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        #gameInfo {
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 22px;
            background-color: rgba(0, 0, 0, 0.7);
            margin: 10px auto;
            width: 800px;
            border-radius: 10px;
        }
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            display: none;
            z-index: 100;
            width: 500px;
            box-shadow: 0 0 30px rgba(255,255,255,0.2);
        }
        .game-over h1 {
            font-size: 42px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        .game-over p {
            font-size: 24px;
            margin-top: 20px;
        }
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div id="gameInfo">
        Ø³Ù„Ø§Ù…Øª Ø¨Ø§Ø²ÛŒÚ©Ù†: <span id="playerHealth">100</span> | 
        Ø³Ù„Ø§Ù…Øª Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ±: <span id="enemyHealth">100</span>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="gameOver" class="game-over">
        <h1 id="resultText"></h1>
        <p>Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Enter Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯</p>
    </div>

    <script>
        // Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const playerHealthEl = document.getElementById('playerHealth');
        const enemyHealthEl = document.getElementById('enemyHealth');
        const gameOverEl = document.getElementById('gameOver');
        const resultTextEl = document.getElementById('resultText');

        // ØªØµØ§ÙˆÛŒØ± Ø¨Ø§Ø²ÛŒ
        const images = {
            player: new Image(),
            enemy: new Image(),
            playerBullet: new Image(),
            enemyBullet: new Image(),
            background: new Image()
        };

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµØ§ÙˆÛŒØ±
        images.player.src = 'https://www.dropbox.com/scl/fi/81uhhp16tvav7lroqysim/player.png?rlkey=5sfcisnzwjjyoc3jbqevt9w21&st=8ggqqfaw&dl=1';
        images.enemy.src = 'https://www.dropbox.com/scl/fi/aq7jej7lx4ivvyyn0xud0/enemy.png?rlkey=ey8qbl1lm9237aqh613fse8mw&st=6o8zsquo&dl=1';
        images.background.src = 'https://i.postimg.cc/MTmJRMGh/Versus-battle-screen-background-with-red-and-blue-bokeh-lights-design-3003.jpg';
        images.playerBullet.src = 'https://www.dropbox.com/scl/fi/xpjdral0g4vrgcp8875yh/imeages.png?rlkey=2mciz8v8tmk6crqohk2hidma3&st=5ws5212g&dl=1';
        images.enemyBullet.src = 'https://www.dropbox.com/scl/fi/l8sqidp2u3f0r0ieq7kt4/images.png?rlkey=vk07u8tpfpvt26zf353qysrli&st=umarb41p&dl=1';

        // ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
        const gameState = {
            player: {
                x: 100,
                y: 300,
                width: 70,
                height: 70,
                speed: 7,
                health: 100,
                bullets: [],
                lastShot: 0,
                shotDelay: 400
            },
            enemy: {
                x: 700,
                y: 300,
                width: 70,
                height: 70,
                speed: 5,
                health: 100,
                bullets: [],
                lastShot: 0,
                shotDelay: 1200,
                moveTimer: 0,
                moveInterval: 50,
                direction: 0,
                targetY: 300
            },
            keys: {},
            gameOver: false,
            confetti: [],
            lastTime: 0
        };

        // Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ú©Ù„ÛŒØ¯
        window.addEventListener('keydown', (e) => {
            const key = e.key.toLowerCase();
            gameState.keys[key] = true;
            
            // Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø§ÛŒÙ†ØªØ±
            if (key === 'enter' && gameState.gameOver) {
                restartGame();
            }
        });

        window.addEventListener('keyup', (e) => {
            const key = e.key.toLowerCase();
            gameState.keys[key] = false;
        });

        // ØªÛŒØ±Ø§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ù…Ø§ÙˆØ³
        canvas.addEventListener('click', (e) => {
            if (!gameState.gameOver) {
                const now = Date.now();
                if (now - gameState.player.lastShot > gameState.player.shotDelay) {
                    shootPlayer();
                    gameState.player.lastShot = now;
                }
            }
        });

        function shootPlayer() {
            gameState.player.bullets.push({
                x: gameState.player.x + gameState.player.width,
                y: gameState.player.y + gameState.player.height / 2 - 15,
                width: 70,
                height: 50,
                speed: 15
            });
        }

        function shootEnemy() {
            gameState.enemy.bullets.push({
                x: gameState.enemy.x - 20,
                y: gameState.enemy.y + gameState.enemy.height / 2 - 15,
                width: 70,
                height: 50,
                speed: 12
            });
        }

        function update(timestamp) {
            if (gameState.gameOver) return;

            const deltaTime = timestamp - gameState.lastTime;
            gameState.lastTime = timestamp;

            // Ø­Ø±Ú©Øª Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø§ W Ùˆ S
            if (gameState.keys['w'] || gameState.keys['arrowup']) {
                gameState.player.y = Math.max(0, gameState.player.y - gameState.player.speed);
            }
            if (gameState.keys['s'] || gameState.keys['arrowdown']) {
                gameState.player.y = Math.min(canvas.height - gameState.player.height, 
                                           gameState.player.y + gameState.player.speed);
            }

            // Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø´Ù…Ù†
            gameState.enemy.moveTimer += deltaTime;
            
            if (gameState.enemy.moveTimer >= gameState.enemy.moveInterval) {
                gameState.enemy.moveTimer = 0;
                
                // ØªØºÛŒÛŒØ± Ù‡Ø¯Ù Ø¨Ù‡ ØµÙˆØ±Øª Ù†Ø±Ù…
                if (Math.random() < 0.3) {
                    gameState.enemy.targetY = Math.random() * (canvas.height - gameState.enemy.height);
                } else {
                    // Ø¯Ù†Ø¨Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø§ Ø§Ø­ØªÙ…Ø§Ù„ Ø¨ÛŒØ´ØªØ±
                    gameState.enemy.targetY = gameState.player.y;
                }
            }

            // Ø­Ø±Ú©Øª Ù†Ø±Ù… Ø¯Ø´Ù…Ù† Ø¨Ù‡ Ø³Ù…Øª Ù‡Ø¯Ù
            const dy = gameState.enemy.targetY - gameState.enemy.y;
            gameState.enemy.y += dy * 0.05;

            // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø´Ù…Ù†
            gameState.enemy.y = Math.max(0, Math.min(canvas.height - gameState.enemy.height, gameState.enemy.y));

            // ØªÛŒØ±Ø§Ù†Ø¯Ø§Ø²ÛŒ Ø¯Ø´Ù…Ù†
            const now = Date.now();
            if (now - gameState.enemy.lastShot > gameState.enemy.shotDelay) {
                const playerInLine = Math.abs(
                    (gameState.player.y + gameState.player.height/2) - 
                    (gameState.enemy.y + gameState.enemy.height/2)
                ) < 100;
                
                if (playerInLine || Math.random() < 0.5) {
                    shootEnemy();
                    gameState.enemy.lastShot = now;
                }
            }

            // Ø­Ø±Ú©Øª ØªÛŒØ±Ù‡Ø§
            gameState.player.bullets.forEach(bullet => {
                bullet.x += bullet.speed;
            });

            gameState.enemy.bullets.forEach(bullet => {
                bullet.x -= bullet.speed;
            });

            // ØªØ´Ø®ÛŒØµ Ø¨Ø±Ø®ÙˆØ±Ø¯ ØªÛŒØ±Ù‡Ø§
            checkCollisions();

            // Ø­Ø°Ù ØªÛŒØ±Ù‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ Ø§Ø² ØµÙØ­Ù‡
            gameState.player.bullets = gameState.player.bullets.filter(bullet => 
                bullet.x < canvas.width + 50);
                
            gameState.enemy.bullets = gameState.enemy.bullets.filter(bullet => 
                bullet.x > -50);

            // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
            if (gameState.player.health <= 0 || gameState.enemy.health <= 0) {
                endGame();
            }

            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
            playerHealthEl.textContent = gameState.player.health;
            enemyHealthEl.textContent = gameState.enemy.health;
        }

        function checkCollisions() {
            // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ù‡ Ø¯Ø´Ù…Ù†
            gameState.player.bullets.forEach((bullet, index) => {
                if (isColliding(bullet, gameState.enemy)) {
                    gameState.enemy.health -= 12;
                    gameState.player.bullets.splice(index, 1);
                    createHitEffect(bullet.x, bullet.y, '#00ff00');
                }
            });

            // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¯Ø´Ù…Ù† Ø¨Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù†
            gameState.enemy.bullets.forEach((bullet, index) => {
                if (isColliding(bullet, gameState.player)) {
                    gameState.player.health -= 10;
                    gameState.enemy.bullets.splice(index, 1);
                    createHitEffect(bullet.x, bullet.y, '#ff0000');
                }
            });
        }

        function isColliding(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        function createHitEffect(x, y, color) {
            for (let i = 0; i < 10; i++) {
                gameState.confetti.push({
                    x: x,
                    y: y,
                    color: color,
                    size: Math.random() * 8 + 4,
                    speedX: (Math.random() - 0.5) * 10,
                    speedY: (Math.random() - 0.5) * 10,
                    life: 30
                });
            }
        }

        function createConfetti() {
            for (let i = 0; i < 300; i++) {
                gameState.confetti.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * -100,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 15 + 5,
                    speedX: (Math.random() - 0.5) * 4,
                    speedY: Math.random() * 8 + 4,
                    rotation: Math.random() * Math.PI * 2,
                    rotationSpeed: (Math.random() - 0.5) * 0.2,
                    life: 100 + Math.random() * 100
                });
            }
        }

        function updateConfetti() {
            for (let i = gameState.confetti.length - 1; i >= 0; i--) {
                const c = gameState.confetti[i];
                c.x += c.speedX;
                c.y += c.speedY;
                c.rotation += c.rotationSpeed;
                c.life--;
                
                if (c.life <= 0) {
                    gameState.confetti.splice(i, 1);
                }
            }
        }

        function drawConfetti() {
            gameState.confetti.forEach(c => {
                ctx.save();
                ctx.translate(c.x, c.y);
                ctx.rotate(c.rotation);
                ctx.fillStyle = c.color;
                ctx.fillRect(-c.size/2, -c.size/2, c.size, c.size);
                ctx.restore();
            });
        }

        function endGame() {
            gameState.gameOver = true;
            createConfetti();
            
            if (gameState.player.health <= 0) {
                resultTextEl.textContent = 'Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ± Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯!';
            } else {
                resultTextEl.textContent = 'Ø¢ÙØ±ÛŒÙ†! Ø´Ù…Ø§ Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ± Ø±Ø§ Ø´Ú©Ø³Øª Ø¯Ø§Ø¯ÛŒØ¯';
            }
            
            gameOverEl.style.display = 'block';
        }

        function draw() {
            // Ø±Ø³Ù… Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
            ctx.drawImage(images.background, 0, 0, canvas.width, canvas.height);

            // Ø±Ø³Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†
            ctx.drawImage(images.player, 
                         gameState.player.x, 
                         gameState.player.y, 
                         gameState.player.width, 
                         gameState.player.height);

            // Ø±Ø³Ù… Ø¯Ø´Ù…Ù†
            ctx.drawImage(images.enemy, 
                         gameState.enemy.x, 
                         gameState.enemy.y, 
                         gameState.enemy.width, 
                         gameState.enemy.height);

            // Ø±Ø³Ù… ØªÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†
            gameState.player.bullets.forEach(bullet => {
                ctx.drawImage(images.playerBullet, bullet.x, bullet.y, bullet.width, bullet.height);
            });

            // Ø±Ø³Ù… ØªÛŒØ±Ù‡Ø§ÛŒ Ø¯Ø´Ù…Ù†
            gameState.enemy.bullets.forEach(bullet => {
                ctx.drawImage(images.enemyBullet, bullet.x, bullet.y, bullet.width, bullet.height);
            });

            // Ù†Ù…Ø§ÛŒØ´ ÙØ´ÙØ´Ù‡
            updateConfetti();
            drawConfetti();
        }

        function restartGame() {
            gameState.player = {
                ...gameState.player,
                x: 100,
                y: 300,
                health: 100,
                bullets: [],
                lastShot: 0
            };
            gameState.enemy = {
                ...gameState.enemy,
                x: 700,
                y: 300,
                health: 100,
                bullets: [],
                targetY: 300,
                lastShot: 0
            };
            gameState.gameOver = false;
            gameState.confetti = [];
            gameOverEl.style.display = 'none';
        }

        // Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ
        function gameLoop(timestamp) {
            update(timestamp);
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµØ§ÙˆÛŒØ±
        let imagesLoaded = 0;
        function checkImagesLoaded() {
            imagesLoaded++;
            if (imagesLoaded === 5) {
                // ØªÙ†Ø¸ÛŒÙ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ø§ÙˆÙ„ÛŒÙ‡ Ø¯Ø´Ù…Ù†
                gameState.enemy.targetY = gameState.enemy.y;
                requestAnimationFrame(gameLoop);
            }
        }

        images.player.onload = checkImagesLoaded;
        images.enemy.onload = checkImagesLoaded;
        images.background.onload = checkImagesLoaded;
        images.playerBullet.onload = checkImagesLoaded;
        images.enemyBullet.onload = checkImagesLoaded;
        
        images.player.onerror = () => {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ± Ø¨Ø§Ø²ÛŒÚ©Ù†');
            checkImagesLoaded();
        };
        images.enemy.onerror = () => {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ± Ø¯Ø´Ù…Ù†');
            checkImagesLoaded();
        };
        images.background.onerror = () => {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡');
            checkImagesLoaded();
        };
        images.playerBullet.onerror = () => {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ± ØªÛŒØ± Ø¨Ø§Ø²ÛŒÚ©Ù†');
            checkImagesLoaded();
        };
        images.enemyBullet.onerror = () => {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ± ØªÛŒØ± Ø¯Ø´Ù…Ù†');
            checkImagesLoaded();
        };
    </script>
</body>
</html>
<style>
    /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ù…ÙˆØ¨Ø§ÛŒÙ„ - Ù†Ø³Ø®Ù‡ Ù†Ù‡Ø§ÛŒÛŒ */
    .mobile-control {
      display: none;
      position: fixed;
      z-index: 100;
      pointer-events: auto;
      user-select: none;
    }
  
    #direction-btns {
  left: 560px;
  bottom: 200px;
  display: flex;
  flex-direction: column;
  gap: 0;
}

#up-btn {
  transform: translateY(-60px); /* Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ù„Ø§ */
}

#down-btn {
  transform: translateY(60px); /* Ù¾Ø§ÛŒÛŒÙ† Ø¢ÙˆØ±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ù¾Ø§ÛŒÛŒÙ† */
}
  
    #up-btn, #down-btn {
      width: 100px;
      height: 100px;
      background-color: rgba(0, 0, 255, 0.5);
      border-radius: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 40px;
      border: 2px solid white;
    }
  
    #fire-btn {
      right: -400px;
      bottom: 130px;
      width: 80px;
      height: 80px;
      background-color: rgba(255, 0, 0, 0.5);
      border-radius: 50%;
      background-image: url('https://cdn-icons-png.flaticon.com/512/785/785116.png');
      background-size: 50%;
      background-position: center;
      background-repeat: no-repeat;
      border: 2px solid white;
    }
  
    #enter-btn {
      bottom: 20px;
      left: 100%;
      transform: translateX(-50%);
      width: 120px;
      height: 60px;
      background-color: rgba(0, 255, 0, 0.5);
      border-radius: 30px;
      color: white;
      font-size: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 2px solid white;
    }
  
    /* ÙÙ‚Ø· Ø¯Ø± Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ù„Ù…Ø³ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ */
    @media (hover: none) and (pointer: coarse) {
      .mobile-control {
        display: flex;
      }
    }
  </style>
  
  <!-- Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† HTML Ù‚Ø¨Ù„ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† ØªÚ¯ body -->
  <div id="direction-btns" class="mobile-control">
    <div id="up-btn" class="mobile-control">â†‘</div>
    <div id="down-btn" class="mobile-control">â†“</div>
  </div>
  <div id="fire-btn" class="mobile-control"></div>
  <div id="enter-btn" class="mobile-control">ENTER</div>
  
  <script>
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† Ú©Ø¯ Ø¨Ù‡ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø§Ø²ÛŒ
  
  // ØªØ´Ø®ÛŒØµ Ù…ÙˆØ¨Ø§ÛŒÙ„
  const isMobile = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
  
  if (isMobile) {
    // ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù„Ù…Ø³ÛŒ
    const upBtn = document.getElementById('up-btn');
    const downBtn = document.getElementById('down-btn');
    const fireBtn = document.getElementById('fire-btn');
    const enterBtn = document.getElementById('enter-btn');
    
    // Ø­Ø±Ú©Øª Ø¨Ø§Ù„Ø§
    const startMoveUp = (e) => {
      if (e) e.preventDefault();
      gameState.keys['w'] = true;
    };
    
    const stopMoveUp = (e) => {
      if (e) e.preventDefault();
      gameState.keys['w'] = false;
    };
    
    // Ø­Ø±Ú©Øª Ù¾Ø§ÛŒÛŒÙ†
    const startMoveDown = (e) => {
      if (e) e.preventDefault();
      gameState.keys['s'] = true;
    };
    
    const stopMoveDown = (e) => {
      if (e) e.preventDefault();
      gameState.keys['s'] = false;
    };
    
    // ØªÛŒØ±Ø§Ù†Ø¯Ø§Ø²ÛŒ
    const fire = (e) => {
      if (e) e.preventDefault();
      const now = Date.now();
      if (now - gameState.player.lastShot > gameState.player.shotDelay) {
        shootPlayer();
        gameState.player.lastShot = now;
      }
    };
    
    // Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯
    const enter = (e) => {
      if (e) e.preventDefault();
      if (gameState.gameOver) {
        restartGame();
      }
    };
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù„Ù…Ø³ÛŒ
    upBtn.addEventListener('touchstart', startMoveUp);
    upBtn.addEventListener('touchend', stopMoveUp);
    downBtn.addEventListener('touchstart', startMoveDown);
    downBtn.addEventListener('touchend', stopMoveDown);
    fireBtn.addEventListener('touchstart', fire);
    enterBtn.addEventListener('touchstart', enter);
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¯Ø± Ø¯Ø³Ú©ØªØ§Ù¾
    upBtn.addEventListener('mousedown', startMoveUp);
    upBtn.addEventListener('mouseup', stopMoveUp);
    downBtn.addEventListener('mousedown', startMoveDown);
    downBtn.addEventListener('mouseup', stopMoveDown);
    fireBtn.addEventListener('click', fire);
    enterBtn.addEventListener('click', enter);
    
    // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø®ØµÙˆØµ Ù…ÙˆØ¨Ø§ÛŒÙ„
    function resizeForMobile() {
      const controlsHeight = 120;
      const windowHeight = window.innerHeight;
      
      canvas.width = Math.min(window.innerWidth, 800);
      canvas.height = windowHeight - controlsHeight;
      
      // ØªØºÛŒÛŒØ± Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù…ØªÙ†Ø§Ø³Ø¨
      const scaleFactor = Math.min(window.innerWidth / 800, (windowHeight - controlsHeight) / 600);
      const fontSize = Math.max(16, 16 * scaleFactor);
      
      document.getElementById('gameInfo').style.fontSize = `${fontSize}px`;
    }
    
    resizeForMobile();
    window.addEventListener('resize', resizeForMobile);
  }
  </script>
  <style>
    /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù¾ÛŒØ´â€ŒÙØ±Ø¶ */
    #direction-btns, #fire-btn, #enter-btn {
      display: none;
    }
  
    /* Ù†Ù…Ø§ÛŒØ´ ÙÙ‚Ø· Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
    @media (max-width: 768px), (hover: none) and (pointer: coarse) {
      #direction-btns {
        display: flex;
        position: fixed;
        left: 560px;
        bottom: 200px;
        flex-direction: column;
        gap: 30px;
        z-index: 1000;
      }
      
      #fire-btn {
        display: flex;
        position: fixed;
        right: -400px;
        bottom: 130px;
        width: 100px;
        height: 100px;
      }
      
      #enter-btn {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 100%;
        transform: translateX(-50%);
      }
    }
  </style>
<!-- Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² ØªÚ¯ <script> Ù¾Ø§ÛŒØ§Ù†ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ -->
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ù†ÙˆÛŒ Ø¬Ø¯ÛŒØ¯ */
        #mainMenu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }
        
        #startBtn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 28px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
            margin: 10px;
        }
        
        #startBtn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }
        
        #difficultyMenu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }
        
        .difficultyBtn {
            background: linear-gradient(135deg, #2196F3, #0D47A1);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 20px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
            margin: 10px;
            width: 200px;
        }
        
        .difficultyBtn:hover {
            transform: scale(1.05);
        }
        
        #easyBtn { background: linear-gradient(135deg, #4CAF50, #2E7D32); }
        #mediumBtn { background: linear-gradient(135deg, #FFA500, #FF8C00); }
        #hardBtn { background: linear-gradient(135deg, #FF4500, #FF0000); }
        #backBtn { background: linear-gradient(135deg, #9E9E9E, #616161); }
        
        #gameTitle {
            color: white;
            font-size: 48px;
            margin-bottom: 50px;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        
        #difficultyTitle {
            color: white;
            font-size: 36px;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
    </style>
    
    <!-- Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ -->
    <div id="mainMenu">
        <h1 id="gameTitle">Ù†Ø¨Ø±Ø¯ Ù†Ù‡Ø§ÛŒÛŒ</h1>
        <button id="startBtn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
    </div>
    
    <!-- Ù…Ù†ÙˆÛŒ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ -->
    <div id="difficultyMenu">
        <h1 id="difficultyTitle">Ø³Ø·Ø­ Ø³Ø®ØªÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</h1>
        <button id="easyBtn" class="difficultyBtn">Ø¢Ø³Ø§Ù†</button>
        <button id="mediumBtn" class="difficultyBtn">Ù…ØªÙˆØ³Ø·</button>
        <button id="hardBtn" class="difficultyBtn">Ø³Ø®Øª</button>
        <button id="backBtn" class="difficultyBtn">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
    </div>
    
    <script>
    // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§
    document.getElementById('gameCanvas').style.display = 'none';
    document.getElementById('gameInfo').style.display = 'none';
    document.getElementById('gameOver').style.display = 'none';
    
    // ØªØ¹Ø±ÛŒÙ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ
    const difficultySettings = {
        easy: { damage: 10, speed: 4, health: 90, shotDelay: 1500 },
        medium: { damage: 20, speed: 5, health: 100, shotDelay: 1200 },
        hard: { damage: 35, speed: 6, health: 110, shotDelay: 700 }
    };
    
    let currentDifficulty = 'medium';
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù†Ùˆ
    document.getElementById('startBtn').addEventListener('click', function() {
        document.getElementById('mainMenu').style.display = 'none';
        document.getElementById('difficultyMenu').style.display = 'flex';
    });
    
    document.getElementById('backBtn').addEventListener('click', function() {
        document.getElementById('difficultyMenu').style.display = 'none';
        document.getElementById('mainMenu').style.display = 'flex';
    });
    
    // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
    function startGame(difficulty) {
        currentDifficulty = difficulty;
        const settings = difficultySettings[difficulty];
        
        // Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
        gameState.enemy.speed = settings.speed;
        gameState.enemy.health = settings.health;
        gameState.enemy.shotDelay = settings.shotDelay;
        
        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ù†Ùˆ
        document.getElementById('difficultyMenu').style.display = 'none';
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
        document.getElementById('gameCanvas').style.display = 'block';
        document.getElementById('gameInfo').style.display = 'block';
        
        // Ø±ÛŒØ³Øª Ø¨Ø§Ø²ÛŒ
        restartGame();
    }
    
    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ
    document.getElementById('easyBtn').addEventListener('click', function() {
        startGame('easy');
    });
    
    document.getElementById('mediumBtn').addEventListener('click', function() {
        startGame('medium');
    });
    
    document.getElementById('hardBtn').addEventListener('click', function() {
        startGame('hard');
    });
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions Ø¨Ø±Ø§ÛŒ Ø§Ø¹Ù…Ø§Ù„ Ø¢Ø³ÛŒØ¨ Ù…ØªÙ†Ø§Ø³Ø¨
    const originalCheckCollisions = checkCollisions;
    checkCollisions = function() {
        // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ù‡ Ø¯Ø´Ù…Ù†
        for (let i = gameState.player.bullets.length - 1; i >= 0; i--) {
            const bullet = gameState.player.bullets[i];
            if (isColliding(bullet, gameState.enemy)) {
                gameState.enemy.health -= 12;
                gameState.player.bullets.splice(i, 1);
                createHitEffect(bullet.x, bullet.y, '#00ff00');
                
                if (gameState.enemy.health <= 0) {
                    endGame(false); // Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø¨Ø±Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†
                    return;
                }
            }
        }
    
        // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¯Ø´Ù…Ù† Ø¨Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù†
        for (let i = gameState.enemy.bullets.length - 1; i >= 0; i--) {
            const bullet = gameState.enemy.bullets[i];
            if (isColliding(bullet, gameState.player)) {
                gameState.player.health -= difficultySettings[currentDifficulty].damage;
                gameState.enemy.bullets.splice(i, 1);
                createHitEffect(bullet.x, bullet.y, '#ff0000');
                
                if (gameState.player.health <= 0) {
                    endGame(true); // Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø¨Ø§Ø®Øª Ø¨Ø§Ø²ÛŒÚ©Ù†
                    return;
                }
            }
        }
    };
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡
    const originalEndGame = endGame;
    endGame = function(playerLost) {
        originalEndGame();
        
        if (playerLost) {
            resultTextEl.textContent = 'Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ± Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯!';
        } else {
            resultTextEl.textContent = 'Ø¢ÙØ±ÛŒÙ†! Ø´Ù…Ø§ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯';
        }
        
        // Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
        gameOverEl.style.display = 'block';
    };
    </script>
    <!-- Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ø¯Ø± Ø¨Ø®Ø´ style Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ -->
<style>
    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø®Ø´ Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø³Ú©ÛŒÙ† */
    #skinMenu {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1001;
        flex-direction: column;
    }
    
    .skin-option {
        width: 150px;
        height: 150px;
        margin: 15px;
        border: 3px solid transparent;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        background-size: cover;
        background-position: center;
    }
    
    .skin-option:hover {
        transform: scale(1.1);
        border-color: #4CAF50;
    }
    
    .skin-option.selected {
        border-color: #FFD700;
        box-shadow: 0 0 20px #FFD700;
    }
    
    #skinTitle {
        color: white;
        font-size: 36px;
        margin-bottom: 30px;
        text-shadow: 0 0 10px rgba(255,255,255,0.5);
    }
    
    #skinContainer {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 800px;
    }
    
    #skinBackBtn {
        background: linear-gradient(135deg, #9E9E9E, #616161);
        color: white;
        border: none;
        padding: 12px 30px;
        font-size: 18px;
        border-radius: 50px;
        cursor: pointer;
        margin-top: 30px;
    }
</style>

<!-- Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† ØªÚ¯ body Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ -->
<div id="skinMenu">
    <h1 id="skinTitle">Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø³Ú©ÛŒÙ† Ø´Ø®ØµÛŒØª</h1>
    <div id="skinContainer">
        <div class="skin-option selected" data-skin="default" style="background-image: url('https://www.dropbox.com/scl/fi/81uhhp16tvav7lroqysim/player.png?rlkey=5sfcisnzwjjyoc3jbqevt9w21&st=8ggqqfaw&dl=1')"></div>
        <div class="skin-option" data-skin="warrior" style="background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTbDt-3UhfO1dYz_MusRNIGXA2jDnPiGLNhqQ&s')"></div>
        <div class="skin-option" data-skin="ninja" style="background-image: url('https://previews.dropbox.com/p/thumb/AClmmLUhG0Wcp-7Yh4TXzxgMBTXKG62jD_u_DNn54sRClUluZi9Nr51iW6JsIM1YLQuD3EvfN0ux5FohrGBtFqTG2m9TdfEKJGPTiX06Urt-PZHZN9VolLRAwbOSIgRxRN4Rk9SIFBa1N13uQjVjcdyZS3aehtN4Qss1bc04OR_cm5jW4ngpiHmzJh32SC2NNXSAAYE7DOynPKJaG8qWHv1ESZ9x2AbQsHWINzLHRB2JzkqgrOZfNQs1QhghsNlYVZZ6phXFlgHxWJI2RUSue6l2eo8ja06s7DCOswwYDN4GjjEeaa3pZjHQM6JaKi1O2dosQbuk2g8zpmw6C9zOK743/p.jpeg?is_prewarmed=true')"></div>
        <div class="skin-option" data-skin="robot" style="background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZLJznqIQJJiIQH2jxXS4DGWBDjN6B1SkJDg&s')"></div>
    </div>
    <button id="skinBackBtn">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
</div>

<!-- Ø§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ø¯Ø± Ø¨Ø®Ø´ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ -->
<script>
// Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§Ø³Ú©ÛŒÙ†
let currentSkin = 'default';
const skinOptions = {
    default: {
        player: 'https://www.dropbox.com/scl/fi/81uhhp16tvav7lroqysim/player.png?rlkey=5sfcisnzwjjyoc3jbqevt9w21&st=8ggqqfaw&dl=1',
        bullet: 'https://www.dropbox.com/scl/fi/xpjdral0g4vrgcp8875yh/imeages.png?rlkey=2mciz8v8tmk6crqohk2hidma3&st=5ws5212g&dl=1'
    },
    warrior: {
        player: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTbDt-3UhfO1dYz_MusRNIGXA2jDnPiGLNhqQ&s',
        bullet: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTWH9GW4MIL4Y4dPEETep7ksnMRQ0UrbuQ0hQ&s'
    },
    ninja: {
        player: 'https://previews.dropbox.com/p/thumb/AClmmLUhG0Wcp-7Yh4TXzxgMBTXKG62jD_u_DNn54sRClUluZi9Nr51iW6JsIM1YLQuD3EvfN0ux5FohrGBtFqTG2m9TdfEKJGPTiX06Urt-PZHZN9VolLRAwbOSIgRxRN4Rk9SIFBa1N13uQjVjcdyZS3aehtN4Qss1bc04OR_cm5jW4ngpiHmzJh32SC2NNXSAAYE7DOynPKJaG8qWHv1ESZ9x2AbQsHWINzLHRB2JzkqgrOZfNQs1QhghsNlYVZZ6phXFlgHxWJI2RUSue6l2eo8ja06s7DCOswwYDN4GjjEeaa3pZjHQM6JaKi1O2dosQbuk2g8zpmw6C9zOK743/p.jpeg?is_prewarmed=true',
        bullet: 'https://previews.dropbox.com/p/thumb/AClVwau1Vt77IsqsHnma1_dDEAycqYTri2hFT1zK5W-6ygi5Le1kmKU1Z9IJ3KQ7QuYTqUgTd8p2193BUN8jIzG-9QtZiR1oGqROCaRfOYwZXkMrzxdpW_B_iXD3MVFlihy2-q-AIlrlvIkH7wwuuvaOE7gHKUkCPadebFl9LGv3cPXfSfGD_gYd57aBGJiub8rst3S7aDHHRiuILQcKASaQjynfCg9vikzlcsQknm_ACpm7x-BTWuhlmFYKTMf7HptyjWUZYyUlAfqHDo_-b4r0j_U-_J06lGBFGXT9Nu8-k158-jCOGee-SUjJC3puUFo/p.png'
    },
    robot: {
        player: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZLJznqIQJJiIQH2jxXS4DGWBDjN6B1SkJDg&s',
        bullet: 'https://www.dropbox.com/scl/fi/xpjdral0g4vrgcp8875yh/imeages.png?rlkey=2mciz8v8tmk6crqohk2hidma3&st=5ws5212g&dl=1'
    }
};

// Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù†ÙˆÛŒ Ø§Ø³Ú©ÛŒÙ†
document.getElementById('startBtn').addEventListener('click', function() {
    document.getElementById('mainMenu').style.display = 'none';
    document.getElementById('skinMenu').style.display = 'flex';
});

document.getElementById('skinBackBtn').addEventListener('click', function() {
    document.getElementById('skinMenu').style.display = 'none';
    document.getElementById('mainMenu').style.display = 'flex';
});

// Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø³Ú©ÛŒÙ†
document.querySelectorAll('.skin-option').forEach(option => {
    option.addEventListener('click', function() {
        // Ø­Ø°Ù Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø² Ù‡Ù…Ù‡ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
        document.querySelectorAll('.skin-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ù‡ Ú¯Ø²ÛŒÙ†Ù‡ ÙØ¹Ù„ÛŒ
        this.classList.add('selected');
        currentSkin = this.getAttribute('data-skin');
        
        // ØªØºÛŒÛŒØ± ØªØµØ§ÙˆÛŒØ± Ø¨Ø§Ø²ÛŒ
        images.player.src = skinOptions[currentSkin].player;
        images.playerBullet.src = skinOptions[currentSkin].bullet;
        
        // Ù†Ù…Ø§ÛŒØ´ Ù…Ù†ÙˆÛŒ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø³Ú©ÛŒÙ†
        setTimeout(() => {
            document.getElementById('skinMenu').style.display = 'none';
            document.getElementById('difficultyMenu').style.display = 'flex';
        }, 500);
    });
});

// ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ startGame Ø¨Ø±Ø§ÛŒ Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³Ú©ÛŒÙ† Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
const originalStartGame = startGame;
startGame = function(difficulty) {
    originalStartGame(difficulty);
    
    // Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³Ú©ÛŒÙ† Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
    images.player.src = skinOptions[currentSkin].player;
    images.playerBullet.src = skinOptions[currentSkin].bullet;
};
</script>
<script>
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ ØµØ­ÛŒØ­
    endGame = function() {
        gameState.gameOver = true;
        createConfetti();
        
        if (gameState.player.health <= 0) {
            resultTextEl.textContent = 'Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ± Ø´Ù…Ø§ Ø±Ø§ Ù†Ø§Ø¨ÙˆØ¯ Ú©Ø±Ø¯! Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯';
        } else {
            resultTextEl.textContent = 'Ø¢ÙØ±ÛŒÙ†! Ø´Ù…Ø§ Ø¢Ù‚Ø§ÛŒ Ø§ÛŒØ²Ø¯ÙØ± Ø±Ø§ Ø´Ú©Ø³Øª Ø¯Ø§Ø¯ÛŒØ¯';
        }
        
        gameOverEl.style.display = 'block';
    };
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions Ø¨Ø±Ø§ÛŒ Ù¾Ø§ÛŒØ§Ù† ØµØ­ÛŒØ­ Ø¨Ø§Ø²ÛŒ
    checkCollisions = function() {
        // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ù‡ Ø¯Ø´Ù…Ù†
        gameState.player.bullets.forEach((bullet, index) => {
            if (isColliding(bullet, gameState.enemy)) {
                gameState.enemy.health -= 12;
                gameState.player.bullets.splice(index, 1);
                createHitEffect(bullet.x, bullet.y, '#00ff00');
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ Ø§Ú¯Ø± Ø³Ù„Ø§Ù…Øª Ø¯Ø´Ù…Ù† ØªÙ…Ø§Ù… Ø´Ø¯
                if (gameState.enemy.health <= 0) {
                    endGame();
                    return;
                }
            }
        });
    
        // ØªÛŒØ±Ù‡Ø§ÛŒ Ø¯Ø´Ù…Ù† Ø¨Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù†
        gameState.enemy.bullets.forEach((bullet, index) => {
            if (isColliding(bullet, gameState.player)) {
                gameState.player.health -= difficultySettings[currentDifficulty].damage;
                gameState.enemy.bullets.splice(index, 1);
                createHitEffect(bullet.x, bullet.y, '#ff0000');
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ Ø§Ú¯Ø± Ø³Ù„Ø§Ù…Øª Ø¨Ø§Ø²ÛŒÚ©Ù† ØªÙ…Ø§Ù… Ø´Ø¯
                if (gameState.player.health <= 0) {
                    endGame();
                    return;
                }
            }
        });
    };
    </script>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„ ØµÙØ­Ù‡ Ø§Ø³Ù¾Ù„Ø´ Ø¨Ø§ ØªØ¶Ù…ÛŒÙ† Ù†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ± */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #splashImage {
            width: 100%;
            height: 100%;
            object-fit: contain;
            opacity: 1;
            transition: opacity 1.5s ease-out;
        }
    </style>
    
    <div id="splashScreen">
        <img id="splashImage" src="https://www.dropbox.com/scl/fi/jg2qkhaf886mh4ijb4gbh/170105c9-c66a-4ba1-83c7-cf58fa887b31.png?rlkey=ekig4rkarsuor3h4es0lukrdp&st=cnrhnv48&dl=1" alt="Ù„ÙˆÚ¯ÙˆÛŒ Ø¨Ø§Ø²ÛŒ">
    </div>
    
    <script>
        // Ø§Ø¨ØªØ¯Ø§ Ù…Ø·Ù…Ø¦Ù† Ù…ÛŒØ´ÙˆÛŒÙ… ØªØµÙˆÛŒØ± Ù„ÙˆØ¯ Ø´Ø¯Ù‡ Ø§Ø³Øª
        document.getElementById('splashImage').onload = function() {
            // Ù¾Ø³ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡ ØªØµÙˆÛŒØ± Ø±Ø§ Ù…Ø­Ùˆ Ù…ÛŒÚ©Ù†ÛŒÙ…
            setTimeout(() => {
                document.getElementById('splashImage').style.opacity = '0';
                
                // Ù¾Ø³ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù…Ø­Ùˆ Ø´Ø¯Ù†
                setTimeout(() => {
                    document.getElementById('splashScreen').style.display = 'none';
                    document.getElementById('mainMenu').style.display = 'flex';
                }, 1500);
            }, 3000);
        };
        
        // Ø§Ú¯Ø± ØªØµÙˆÛŒØ± Ù„ÙˆØ¯ Ù†Ø´Ø¯
        document.getElementById('splashImage').onerror = function() {
            document.getElementById('splashScreen').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'flex';
        };
    </script>

        <script>
            // ======== Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú¯Ø²ÛŒÙ†Ù‡ Coming Soon Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø³Ø®ØªÛŒ ========
                
                // 3. Ø§Ø³ØªØ§ÛŒÙ„â€ŒØ¯Ù‡ÛŒ Ø¨Ù‡ Ú¯Ø²ÛŒÙ†Ù‡
                comingSoonBtn.style.background = 'linear-gradient(135deg, #333333, #666666)';
                comingSoonBtn.style.cursor = 'not-allowed';
                comingSoonBtn.style.opacity = '0.7';
                comingSoonBtn.style.position = 'relative';
                comingSoonBtn.style.overflow = 'hidden';
                
                // 4. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§ÙÚ©Øª Ø¯Ø±Ø®Ø´Ø´
                const shineEffect = document.createElement('div');
                shineEffect.style.position = 'absolute';
                shineEffect.style.top = '-50%';
                shineEffect.style.left = '-50%';
                shineEffect.style.width = '200%';
                shineEffect.style.height = '200%';
                shineEffect.style.background = 'linear-gradient(to bottom right, rgba(255,255,255,0) 45%, rgba(255,255,255,0.8) 50%, rgba(255,255,255,0) 55%)';
                shineEffect.style.animation = 'shine 3s infinite';
                shineEffect.style.transform = 'rotate(30deg)';
                
                comingSoonBtn.appendChild(shineEffect);
                
                // 5. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ù…Ù†Ùˆ (Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ú©Ù…Ù‡ Ø³Ø®Øª)
                const hardBtn = document.getElementById('hardBtn');
                if (hardBtn) {
                    difficultyMenu.insertBefore(comingSoonBtn, hardBtn.nextSibling);
                } else {
                    difficultyMenu.appendChild(comingSoonBtn);
                }
                
                // 6. ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒÚ©
                comingSoonBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØª 1.5 Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!\n\nÙØ¹Ù„Ø§Ù‹ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø³Ø·Ø­ Ø³Ø®Øª Ù„Ø°Øª Ø¨Ø¨Ø±ÛŒØ¯.');
                    return false;
                });
            }
            
            // 7. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù…
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shine {
                    0% { transform: translateX(-100%) rotate(30deg); }
                    100% { transform: translateX(100%) rotate(30deg); }
                }
                
                #comingSoonBtn:hover {
                    transform: none !important;
                    box-shadow: none !important;
                }
            `;
            document.head.appendChild(style);
            </script>
            <script>
                // ========== Ú©Ø¯ ØµØ¯Ø§Ù‡Ø§ Ø¨Ø§ Ù…Ù†Ø§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯ ==========
                const gameSounds = {
                  bgMusic: new Audio('https://sedatoseda.com/wp-content/uploads/stranger-things-124008.mp3'),
                  gun: new Audio('https://sedatoseda.com/wp-content/uploads/Police-Sound-Gun1.mp3'),
                  donkey: new Audio('https://sedatoseda.com/wp-content/uploads/donkey-sound1.mp3'),
                  click: new Audio('https://www.soundjay.com/buttons/sounds/button-21.mp3'),
                  sword: new Audio('https://biaupload.com/static/files-2025-04/org-08e7ff479e094.mp3'),
                  laser: new Audio('')
                };
                
                // ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØµØ¯Ø§Ù‡Ø§
                let isSoundEnabled = true;
                gameSounds.bgMusic.volume = 0.17;
                gameSounds.gun.volume = 0.20;
                gameSounds.donkey.volume = 0.40;
                gameSounds.click.volume = 0.7;
                gameSounds.sword.volume = 0.40;
                gameSounds.laser.volume = 0.8;
                gameSounds.bgMusic.loop = true;
                
                // ØªØ§Ø¨Ø¹ Ù¾Ø®Ø´ ØµØ¯Ø§ Ø¨Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§
                function playSound(soundName) {
                  if (!isSoundEnabled) return;
                  
                  try {
                    const sound = gameSounds[soundName];
                    sound.currentTime = 0;
                    sound.play().catch(e => {
                      console.log('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§:', e);
                      // ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯ Ø¨Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯ ØµØ¯Ø§
                      sound.load();
                      sound.play().catch(e => console.log('Ø®Ø·Ø§ Ø¯Ø± ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯:', e));
                    });
                  } catch(e) {
                    console.log('Ø®Ø·Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§:', e);
                  }
                }
                
                // Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
                window.addEventListener('DOMContentLoaded', () => {
                  setTimeout(() => {
                    playSound('bgMusic');
                  }, 1000);
                });
                
                // ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ shootPlayer
                const originalShootPlayer = shootPlayer;
                shootPlayer = function() {
                  if (currentSkin === 'warrior') {
                    playSound('donkey');
                  } else if (currentSkin === 'ninja') {
                    playSound('sword');
                  } else if (currentSkin === 'robot') {
                    playSound('laser');
                  } else {
                    playSound('gun');
                  }
                  originalShootPlayer();
                };
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ú©Ù…Ù‡ Ú©Ù†ØªØ±Ù„ ØµØ¯Ø§
                const soundBtn = document.createElement('button');
                soundBtn.id = 'soundControl';
                soundBtn.innerHTML = 'ğŸ”Š';
                soundBtn.style.position = 'fixed';
                soundBtn.style.top = '10px';
                soundBtn.style.left = '10px';
                soundBtn.style.zIndex = '1000';
                soundBtn.style.background = 'rgba(0,0,0,0.7)';
                soundBtn.style.color = 'white';
                soundBtn.style.border = '2px solid white';
                soundBtn.style.borderRadius = '50%';
                soundBtn.style.width = '40px';
                soundBtn.style.height = '40px';
                soundBtn.style.fontSize = '20px';
                soundBtn.style.cursor = 'pointer';
                soundBtn.style.display = 'flex';
                soundBtn.style.alignItems = 'center';
                soundBtn.style.justifyContent = 'center';
                
                // Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„ÛŒÚ© Ø¯Ú©Ù…Ù‡ ØµØ¯Ø§
                soundBtn.addEventListener('click', function() {
                  isSoundEnabled = !isSoundEnabled;
                  this.innerHTML = isSoundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
                  this.style.color = isSoundEnabled ? 'white' : '#ff0000';
                  
                  if (isSoundEnabled) {
                    playSound('bgMusic');
                  } else {
                    gameSounds.bgMusic.pause();
                  }
                  
                  playSound('click');
                });
                
                document.body.appendChild(soundBtn);
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØµØ¯Ø§ Ø¨Ù‡ Ú©Ù„ÛŒÙ‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
                document.querySelectorAll('button').forEach(btn => {
                  if (btn.id !== 'soundControl') {
                    btn.addEventListener('click', () => playSound('click'));
                    btn.addEventListener('mouseenter', () => {
                      if (isSoundEnabled) gameSounds.click.currentTime = 0;
                    });
                  }
                });
                </script>
                <script>
                    // ========== Ú©Ø¯ Ø§ØµÙ„Ø§Ø­ÛŒ Ø¨Ø±Ø§ÛŒ ØµØ¯Ø§ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ ==========
                    const bgMusic = new Audio('https://sedatoseda.com/wp-content/uploads/stranger-things-124008.mp3');
                    bgMusic.volume = 0.3;
                    bgMusic.loop = true;
                    
                    let isSoundEnabled = true;
                    
                    // ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
                    function startBackgroundMusic() {
                      // Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ù…Ø´Ú©Ù„ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ú©Ù„ÛŒÚ© Ø§ÙˆÙ„ÛŒÙ‡ Ø±Ø§ Ø­Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
                      bgMusic.play().catch(e => {
                        console.log('Ø¨Ø±Ø§ÛŒ Ù¾Ø®Ø´ ØµØ¯Ø§ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ¹Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± Ø§Ø³Øª');
                        // Ø§Ú¯Ø± Ù¾Ø®Ø´ Ù†Ø´Ø¯ØŒ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ÙˆÙ„ÛŒÙ† Ú©Ù„ÛŒÚ© Ú©Ø§Ø±Ø¨Ø± Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ù…ÛŒâ€ŒÚ©Ù†Ø¯
                        document.addEventListener('click', function tryPlay() {
                          bgMusic.play().then(() => {
                            document.removeEventListener('click', tryPlay);
                          }).catch(e => console.log('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§:', e));
                        }, { once: true });
                      });
                    }
                    
                    // Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
                    window.addEventListener('DOMContentLoaded', () => {
                      setTimeout(startBackgroundMusic, 1000);
                    });
                    
                    // Ø¯Ú©Ù…Ù‡ Ú©Ù†ØªØ±Ù„ ØµØ¯Ø§
                    const soundBtn = document.createElement('button');
                    soundBtn.innerHTML = 'ğŸ”Š';
                    soundBtn.style.position = 'fixed';
                    soundBtn.style.top = '10px';
                    soundBtn.style.left = '10px';
                    soundBtn.style.zIndex = '1000';
                    soundBtn.style.background = 'rgba(0,0,0,0.7)';
                    soundBtn.style.border = 'none';
                    soundBtn.style.borderRadius = '50%';
                    soundBtn.style.width = '40px';
                    soundBtn.style.height = '40px';
                    soundBtn.style.fontSize = '20px';
                    soundBtn.style.cursor = 'pointer';
                    
                    soundBtn.addEventListener('click', function() {
                      isSoundEnabled = !isSoundEnabled;
                      this.innerHTML = isSoundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
                      isSoundEnabled ? bgMusic.play() : bgMusic.pause();
                    });
                    
                    document.body.appendChild(soundBtn);
                    </script>
<script>
    // ========== Ú©Ø¯ Ø§ØµÙ„Ø§Ø­ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ØµØ­ÛŒØ­ Ø¨Ø§Ø²ÛŒ ==========
    
    // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ
    let gameInitialized = false;
    let gameStarted = false;
    
    // ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
    function startGameAfterSelections() {
      // ÙÙ‚Ø· Ø§Ú¯Ø± Ø¨Ø§Ø²ÛŒ Ù‡Ù†ÙˆØ² Ø´Ø±ÙˆØ¹ Ù†Ø´Ø¯Ù‡
      if (!gameStarted) {
        gameInitialized = true;
        gameStarted = true;
        
        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ù†ÙˆÙ‡Ø§
        document.getElementById('skinMenu').style.display = 'none';
        document.getElementById('difficultyMenu').style.display = 'none';
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
        document.getElementById('gameCanvas').style.display = 'block';
        document.getElementById('gameInfo').style.display = 'block';
        
        // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
        resetGameState();
        
        // Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ
        playSound('bgMusic');
      }
    }
    
    // ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ resetGameState
    function resetGameState() {
      gameState.player = {
        ...gameState.player,
        health: 100,
        bullets: [],
        lastShot: 0
      };
      
      gameState.enemy = {
        ...gameState.enemy,
        health: 100,
        bullets: [],
        lastShot: 0
      };
      
      gameState.gameOver = false;
      gameState.confetti = [];
      
      // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
      document.getElementById('playerHealth').textContent = '100';
      document.getElementById('enemyHealth').textContent = '100';
      
      // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
      document.getElementById('gameOver').style.display = 'none';
    }
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ø¯Ø±Ø³Øª
    const originalEndGame = endGame;
    endGame = function() {
      if (gameStarted) {
        originalEndGame();
      }
    };
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions
    const originalCheckCollisions = checkCollisions;
    checkCollisions = function() {
      if (gameStarted) {
        originalCheckCollisions();
      }
    };
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨
    document.getElementById('easyBtn').addEventListener('click', function() {
      currentDifficulty = 'easy';
      startGameAfterSelections();
    });
    
    document.getElementById('mediumBtn').addEventListener('click', function() {
      currentDifficulty = 'medium';
      startGameAfterSelections();
    });
    
    document.getElementById('hardBtn').addEventListener('click', function() {
      currentDifficulty = 'hard';
      startGameAfterSelections();
    });
    </script>
    <script>
        // ========== Ú©Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ù„ÙˆØ¯ÛŒÙ†Ú¯ ØªØµØ§ÙˆÛŒØ± ==========
        
        // ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        function showLoadingScreen() {
          const loadingScreen = document.createElement('div');
          loadingScreen.id = 'loadingScreen';
          loadingScreen.style.position = 'fixed';
          loadingScreen.style.top = '0';
          loadingScreen.style.left = '0';
          loadingScreen.style.width = '100%';
          loadingScreen.style.height = '100%';
          loadingScreen.style.backgroundColor = '#000';
          loadingScreen.style.display = 'flex';
          loadingScreen.style.flexDirection = 'column';
          loadingScreen.style.alignItems = 'center';
          loadingScreen.style.justifyContent = 'center';
          loadingScreen.style.zIndex = '9999';
          
          const loadingText = document.createElement('div');
          loadingText.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ...';
          loadingText.style.color = '#fff';
          loadingText.style.fontSize = '24px';
          loadingText.style.marginTop = '20px';
          
          const spinner = document.createElement('div');
          spinner.style.border = '5px solid #333';
          spinner.style.borderTop = '5px solid #f00';
          spinner.style.borderRadius = '50%';
          spinner.style.width = '50px';
          spinner.style.height = '50px';
          spinner.style.animation = 'spin 1s linear infinite';
          
          const style = document.createElement('style');
          style.textContent = `
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `;
          
          loadingScreen.appendChild(spinner);
          loadingScreen.appendChild(loadingText);
          document.body.appendChild(loadingScreen);
          document.head.appendChild(style);
        }
        
        // ØªØ§Ø¨Ø¹ Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        function hideLoadingScreen() {
          const loadingScreen = document.getElementById('loadingScreen');
          if (loadingScreen) {
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
              loadingScreen.remove();
            }, 500);
          }
        }
        
        // ØªØ§Ø¨Ø¹ Ù„ÙˆØ¯ ØªØµØ§ÙˆÛŒØ±
        function loadGameAssets() {
          return new Promise((resolve) => {
            const imagesToLoad = [
              'https://www.dropbox.com/scl/fi/81uhhp16tvav7lroqysim/player.png?rlkey=5sfcisnzwjjyoc3jbqevt9w21&st=8ggqqfaw&dl=1',
              'https://www.dropbox.com/scl/fi/aq7jej7lx4ivvyyn0xud0/enemy.png?rlkey=ey8qbl1lm9237aqh613fse8mw&st=6o8zsquo&dl=1',
              'https://www.dropbox.com/scl/fi/45t9r6y2necad8bm8rh0b/_.jpg?rlkey=7h0jova0u0ofz48z73vxnlp0q&st=iruso0io&dl=0',
              'https://www.dropbox.com/scl/fi/xpjdral0g4vrgcp8875yh/imeages.png?rlkey=2mciz8v8tmk6crqohk2hidma3&st=5ws5212g&dl=1',
              'https://www.dropbox.com/scl/fi/l8sqidp2u3f0r0ieq7kt4/images.png?rlkey=vk07u8tpfpvt26zf353qysrli&st=umarb41p&dl=1',
              'https://www.dropbox.com/scl/fi/6t3mkk5bn1ykabz1s1auv/1-scaled.png?rlkey=maogyrnlme05uxljgcmffc90o&st=da06idla&dl=0',
              'https://postimg.cc/34K3BGxL'
            ];
            
            let loadedCount = 0;
            const totalImages = imagesToLoad.length;
            
            imagesToLoad.forEach(src => {
              const img = new Image();
              img.onload = () => {
                loadedCount++;
                if (loadedCount === totalImages) {
                  resolve();
                }
              };
              img.onerror = () => {
                loadedCount++;
                if (loadedCount === totalImages) {
                  resolve();
                }
              };
              img.src = src;
            });
          });
        }
        
        // Ø§Ø¬Ø±Ø§ÛŒ ÙØ±Ø¢ÛŒÙ†Ø¯ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        window.addEventListener('DOMContentLoaded', () => {
          showLoadingScreen();
          
          loadGameAssets().then(() => {
            setTimeout(() => {
              hideLoadingScreen();
              
              // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ù¾Ø³ Ø§Ø² Ù„ÙˆØ¯ Ú©Ø§Ù…Ù„
              document.getElementById('mainMenu').style.display = 'flex';
            }, 1000);
          });
        });
        </script>
        <script>
            // ========== Ú©Ø¯ Ø§ØµÙ„Ø§Ø­ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ ==========
            
            // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ
            let gameReady = false;
            let gameActive = false;
            
            // ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
            function startGame() {
              if (!gameReady) return;
              
              gameActive = true;
              
              // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ù†ÙˆÙ‡Ø§
              document.getElementById('mainMenu').style.display = 'none';
              document.getElementById('skinMenu').style.display = 'none';
              document.getElementById('difficultyMenu').style.display = 'none';
              
              // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
              document.getElementById('gameCanvas').style.display = 'block';
              document.getElementById('gameInfo').style.display = 'block';
              
              // Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
              resetGameState();
              
              // Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ
              playSound('bgMusic');
            }
            
            // ØªØ§Ø¨Ø¹ Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
            function resetGameState() {
              gameState.player.health = 100;
              gameState.enemy.health = 100;
              gameState.player.bullets = [];
              gameState.enemy.bullets = [];
              gameState.gameOver = false;
              gameState.confetti = [];
              
              // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
              document.getElementById('playerHealth').textContent = '100';
              document.getElementById('enemyHealth').textContent = '100';
              
              // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
              document.getElementById('gameOver').style.display = 'none';
            }
            
            // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame
            const originalEndGame = endGame;
            endGame = function() {
              if (gameActive) {
                originalEndGame();
              }
            };
            
            // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions
            const originalCheckCollisions = checkCollisions;
            checkCollisions = function() {
              if (gameActive) {
                originalCheckCollisions();
              }
            };
            
            // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ update
            const originalUpdate = update;
            update = function(timestamp) {
              if (gameActive) {
                originalUpdate(timestamp);
              }
            };
            
            // ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨
            document.getElementById('easyBtn').addEventListener('click', function() {
              currentDifficulty = 'easy';
              gameReady = true;
              startGame();
            });
            
            document.getElementById('mediumBtn').addEventListener('click', function() {
              currentDifficulty = 'medium';
              gameReady = true;
              startGame();
            });
            
            document.getElementById('hardBtn').addEventListener('click', function() {
              currentDifficulty = 'hard';
              gameReady = true;
              startGame();
            });
            
            // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§
            gameActive = false;
            gameReady = false;
            </script>
            <script>
                // ========== Ú©Ø¯ Ø§ØµÙ„Ø§Ø­ÛŒ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ ==========
                
                // 1. Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ
                let gameInitialized = false;
                let gameRunning = false;
                let inMenu = true;
                
                // 2. ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
                function startGameAfterSelection() {
                  // ÙÙ‚Ø· Ø§Ú¯Ø± Ø¯Ø± Ù…Ù†Ùˆ Ù‡Ø³ØªÛŒÙ… Ùˆ Ø¨Ø§Ø²ÛŒ Ø´Ø±ÙˆØ¹ Ù†Ø´Ø¯Ù‡
                  if (inMenu && !gameRunning) {
                    gameInitialized = true;
                    gameRunning = true;
                    inMenu = false;
                    
                    // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ù…Ù†ÙˆÙ‡Ø§
                    document.querySelectorAll('.menu-screen').forEach(menu => {
                      menu.style.display = 'none';
                    });
                    
                    // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
                    document.getElementById('gameCanvas').style.display = 'block';
                    document.getElementById('gameInfo').style.display = 'block';
                    
                    // Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
                    resetGameState();
                    
                    console.log('Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ø±ÙˆØ¹ Ø´Ø¯');
                  }
                }
                
                // 3. ØªØ§Ø¨Ø¹ Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø¨Ø§Ø²ÛŒ
                function resetGameState() {
                  // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
                  gameState.player.health = 100;
                  gameState.player.bullets = [];
                  gameState.player.lastShot = 0;
                  
                  // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¯Ø´Ù…Ù†
                  gameState.enemy.health = 100;
                  gameState.enemy.bullets = [];
                  gameState.enemy.lastShot = 0;
                  
                  // Ø±ÛŒØ³Øª Ø³Ø§ÛŒØ± ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§
                  gameState.gameOver = false;
                  gameState.confetti = [];
                  
                  // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
                  document.getElementById('playerHealth').textContent = '100';
                  document.getElementById('enemyHealth').textContent = '100';
                  
                  // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
                  document.getElementById('gameOver').style.display = 'none';
                }
                
                // 4. ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ endGame Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ø¯Ø±Ø³Øª
                const originalEndGame = endGame;
                endGame = function() {
                  if (gameRunning) {
                    originalEndGame();
                  }
                };
                
                // 5. ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ update Ø¨Ø±Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ù…Ù†ÙˆÙ‡Ø§
                const originalUpdate = update;
                update = function(timestamp) {
                  if (gameRunning) {
                    originalUpdate(timestamp);
                  }
                };
                
                // 6. ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ checkCollisions
                const originalCheckCollisions = checkCollisions;
                checkCollisions = function() {
                  if (gameRunning) {
                    originalCheckCollisions();
                  }
                };
                
                // 7. ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø¯Ø´ÙˆØ§Ø±ÛŒ
                document.getElementById('easyBtn').addEventListener('click', function() {
                  currentDifficulty = 'easy';
                  startGameAfterSelection();
                });
                
                document.getElementById('mediumBtn').addEventListener('click', function() {
                  currentDifficulty = 'medium';
                  startGameAfterSelection();
                });
                
                document.getElementById('hardBtn').addEventListener('click', function() {
                  currentDifficulty = 'hard';
                  startGameAfterSelection();
                });
                
                // 8. Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
                window.addEventListener('DOMContentLoaded', function() {
                  // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§
                  gameInitialized = false;
                  gameRunning = false;
                  inMenu = true;
                  
                  // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
                  document.getElementById('gameCanvas').style.display = 'none';
                  document.getElementById('gameInfo').style.display = 'none';
                  document.getElementById('gameOver').style.display = 'none';
                  
                  console.log('Ø¨Ø§Ø²ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª - Ù…Ù†ØªØ¸Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±');
                });
                </script>
                <script>
                    // ========== Ú©Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ ==========
                    
                    // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ
                    let gameReady = false; // Ø¢ÛŒØ§ Ø¨Ø§Ø²ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØŸ
                    let gameActive = false; // Ø¢ÛŒØ§ Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³ØªØŸ
                    
                    // ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
                    function startGame(difficulty) {
                        // ÙÙ‚Ø· Ø§Ú¯Ø± Ø¨Ø§Ø²ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª Ùˆ Ù‡Ù†ÙˆØ² Ø´Ø±ÙˆØ¹ Ù†Ø´Ø¯Ù‡
                        if (!gameActive) {
                            currentDifficulty = difficulty;
                            const settings = difficultySettings[difficulty];
                            
                            // Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø·Ø­ Ø¯Ø´ÙˆØ§Ø±ÛŒ
                            gameState.enemy.speed = settings.speed;
                            gameState.enemy.health = settings.health;
                            gameState.enemy.shotDelay = settings.shotDelay;
                            
                            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ù†ÙˆÙ‡Ø§
                            document.getElementById('mainMenu').style.display = 'none';
                            document.getElementById('skinMenu').style.display = 'none';
                            document.getElementById('difficultyMenu').style.display = 'none';
                            
                            // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
                            document.getElementById('gameCanvas').style.display = 'block';
                            document.getElementById('gameInfo').style.display = 'block';
                            
                            // Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
                            resetGameState();
                            
                            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ
                            gameActive = true;
                            gameReady = true;
                            
                            // Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ
                            playSound('bgMusic');
                        }
                    }
                    
                    // ØªØ§Ø¨Ø¹ Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø¨Ø§Ø²ÛŒ
                    function resetGameState() {
                        // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
                        gameState.player.health = 100;
                        gameState.player.bullets = [];
                        gameState.player.lastShot = 0;
                        
                        // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¯Ø´Ù…Ù†
                        gameState.enemy.health = 100;
                        gameState.enemy.bullets = [];
                        gameState.enemy.lastShot = 0;
                        
                        // Ø±ÛŒØ³Øª Ø³Ø§ÛŒØ± ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§
                        gameState.gameOver = false;
                        gameState.confetti = [];
                        
                        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
                        document.getElementById('playerHealth').textContent = '100';
                        document.getElementById('enemyHealth').textContent = '100';
                        
                        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
                        document.getElementById('gameOver').style.display = 'none';
                    }
                    
                    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ update Ø¨Ø±Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ù…Ù†ÙˆÙ‡Ø§
                    const originalUpdate = update;
                    update = function(timestamp) {
                        if (gameActive) {
                            originalUpdate(timestamp);
                        }
                    };
                    
                    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions
                    const originalCheckCollisions = checkCollisions;
                    checkCollisions = function() {
                        if (gameActive) {
                            originalCheckCollisions();
                        }
                    };
                    
                    // ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame
                    const originalEndGame = endGame;
                    endGame = function() {
                        if (gameActive) {
                            originalEndGame();
                        }
                    };
                    
                    // ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø·Ø­ Ø¯Ø´ÙˆØ§Ø±ÛŒ
                    document.getElementById('easyBtn').addEventListener('click', function() {
                        startGame('easy');
                    });
                    
                    document.getElementById('mediumBtn').addEventListener('click', function() {
                        startGame('medium');
                    });
                    
                    document.getElementById('hardBtn').addEventListener('click', function() {
                        startGame('hard');
                    });
                    
                    // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§
                    window.addEventListener('DOMContentLoaded', function() {
                        gameReady = false;
                        gameActive = false;
                        
                        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
                        document.getElementById('gameCanvas').style.display = 'none';
                        document.getElementById('gameInfo').style.display = 'none';
                        document.getElementById('gameOver').style.display = 'none';
                    });
                    </script>
                    <script>
                        // ========== Ú©Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡ Ø³Ø§Ø²ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ ==========
                        
                        // ØªØ§Ø¨Ø¹ ØªØ´Ø®ÛŒØµ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
                        function isMobile() {
                          return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                        }
                        
                        // ØªØ§Ø¨Ø¹ ØªÙ†Ø¸ÛŒÙ… Ø§Ù†Ø¯Ø§Ø²Ù‡ Ú©Ø§Ù†ÙˆØ§Ø³ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
                        function setupMobileCanvas() {
                          if (!isMobile()) return;
                        
                          const canvas = document.getElementById('gameCanvas');
                          const gameInfo = document.getElementById('gameInfo');
                          const windowWidth = window.innerWidth;
                          const windowHeight = window.innerHeight;
                          
                          // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ø³Ø¨Øª Ø§Ø¨Ø¹Ø§Ø¯ Ù…Ù†Ø§Ø³Ø¨ (16:9)
                          const targetRatio = 16 / 9;
                          let canvasWidth, canvasHeight;
                          
                          if (windowWidth / windowHeight > targetRatio) {
                            // Ø¹Ø±Ø¶ Ø²ÛŒØ§Ø¯ Ø§Ø³Øª (Ù„Ù†Ø¯Ø§Ø³Ú©ÛŒÙ¾)
                            canvasHeight = Math.min(windowHeight, 600);
                            canvasWidth = canvasHeight * targetRatio;
                          } else {
                            // Ø§Ø±ØªÙØ§Ø¹ Ø²ÛŒØ§Ø¯ Ø§Ø³Øª (Ù¾Ø±ØªØ±Ù‡)
                            canvasWidth = Math.min(windowWidth, 800);
                            canvasHeight = canvasWidth / targetRatio;
                          }
                          
                          // Ø§Ø¹Ù…Ø§Ù„ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø¬Ø¯ÛŒØ¯
                          canvas.width = canvasWidth;
                          canvas.height = canvasHeight;
                          
                          // ØªÙ†Ø¸ÛŒÙ… Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ù†Ø§Ø³Ø¨
                          canvas.style.width = '100%';
                          canvas.style.height = 'auto';
                          canvas.style.maxWidth = canvasWidth + 'px';
                          canvas.style.maxHeight = canvasHeight + 'px';
                          canvas.style.margin = '10px auto';
                          
                          // ØªÙ†Ø¸ÛŒÙ… ÙÙˆÙ†Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²ÛŒ
                          if (gameInfo) {
                            gameInfo.style.fontSize = '16px';
                            gameInfo.style.width = '95%';
                            gameInfo.style.padding = '8px';
                          }
                          
                          // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ù¾Ø±ØªØ±Ù‡
                          if (windowHeight > windowWidth) {
                            showOrientationAlert();
                          }
                        }
                        
                        // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø´Ø¯Ø§Ø± Ø¬Ù‡Øª Ú†Ø±Ø®Ø´ ØµÙØ­Ù‡
                        function showOrientationAlert() {
                          const existingAlert = document.getElementById('orientationAlert');
                          if (existingAlert) return;
                          
                          const alertDiv = document.createElement('div');
                          alertDiv.id = 'orientationAlert';
                          alertDiv.innerHTML = `
                            <div style="
                              position: fixed;
                              top: 0;
                              left: 0;
                              width: 100%;
                              height: 100%;
                              background: rgba(0,0,0,0.9);
                              display: flex;
                              flex-direction: column;
                              justify-content: center;
                              align-items: center;
                              z-index: 9999;
                              color: white;
                              text-align: center;
                              padding: 20px;
                            ">
                              <h2>Ø¨Ø±Ø§ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ø¨Ù‡ØªØ± Ø¨Ø§Ø²ÛŒ</h2>
                              <p>Ù„Ø·ÙØ§Ù‹ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙÙ‚ÛŒ Ø¨Ú†Ø±Ø®Ø§Ù†ÛŒØ¯</p>
                              <div style="font-size: 50px; margin: 20px;">â†»</div>
                              <p>Ø¨Ø§Ø²ÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯</p>
                            </div>
                          `;
                          
                          document.body.appendChild(alertDiv);
                        }
                        
                        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù‡Ø´Ø¯Ø§Ø± Ø¬Ù‡Øª
                        function hideOrientationAlert() {
                          const alertDiv = document.getElementById('orientationAlert');
                          if (alertDiv) {
                            alertDiv.remove();
                          }
                        }
                        
                        // Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØºÛŒÛŒØ± Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù¾Ù†Ø¬Ø±Ù‡
                        window.addEventListener('resize', function() {
                          setupMobileCanvas();
                          if (window.innerWidth > window.innerHeight) {
                            hideOrientationAlert();
                          }
                        });
                        
                        // Ø§Ø¬Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                        window.addEventListener('load', function() {
                          setupMobileCanvas();
                          
                          // Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
                          const style = document.createElement('style');
                          style.textContent = `
                            @media (max-width: 768px) {
                              body {
                                overflow: auto;
                                touch-action: manipulation;
                              }
                              #gameCanvas {
                                background-size: contain !important;
                                background-position: center center !important;
                              }
                              .mobile-control {
                                display: flex !important;
                              }
                            }
                          `;
                          document.head.appendChild(style);
                        });
                        </script>
<script>
    // ========== Ú©Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª ØªØµØ§ÙˆÛŒØ± Ø§Ø³Ú©ÛŒÙ† Ù†ÛŒÙ†Ø¬Ø§ ==========
    
    // ØªØ¹Ø±ÛŒÙ Ø§Ø³Ú©ÛŒÙ† Ù†ÛŒÙ†Ø¬Ø§ Ø¨Ø§ Ù…Ù†Ø§Ø¨Ø¹ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†
    const ninjaSkin = {
        player: [
            'https://postimg.cc/34K3BGxL',
            'https://previews.dropbox.com/p/thumb/AClmmLUhG0Wcp-7Yh4TXzxgMBTXKG62jD_u_DNn54sRClUluZi9Nr51iW6JsIM1YLQuD3EvfN0ux5FohrGBtFqTG2m9TdfEKJGPTiX06Urt-PZHZN9VolLRAwbOSIgRxRN4Rk9SIFBa1N13uQjVjcdyZS3aehtN4Qss1bc04OR_cm5jW4ngpiHmzJh32SC2NNXSAAYE7DOynPKJaG8qWHv1ESZ9x2AbQsHWINzLHRB2JzkqgrOZfNQs1QhghsNlYVZZ6phXFlgHxWJI2RUSue6l2eo8ja06s7DCOswwYDN4GjjEeaa3pZjHQM6JaKi1O2dosQbuk2g8zpmw6C9zOK743/p.jpeg?is_prewarmed=true' // Ù„ÛŒÙ†Ú© Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†
        ],
        bullet: [
            'https://www.dropbox.com/scl/fi/6t3mkk5bn1ykabz1s1auv/1-scaled.png?rlkey=maogyrnlme05uxljgcmffc90o&st=da06idla&dl=0',
            'https://i.ibb.co/0jQY9hX/ninja-bullet-backup.png' // Ù„ÛŒÙ†Ú© Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†
        ]
    };
    
    // ØªØ§Ø¨Ø¹ Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†
    function loadNinjaSkin() {
        // Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± Ø¨Ø§Ø²ÛŒÚ©Ù†
        const playerImg = new Image();
        playerImg.onload = function() {
            images.player.src = this.src;
        };
        playerImg.onerror = function() {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± Ù†ÛŒÙ†Ø¬Ø§ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØµÙˆÛŒØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†');
            images.player.src = ninjaSkin.player[1];
        };
        playerImg.src = ninjaSkin.player[0];
    
        // Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± ØªÛŒØ±
        const bulletImg = new Image();
        bulletImg.onload = function() {
            images.playerBullet.src = this.src;
        };
        bulletImg.onerror = function() {
            console.log('Ø®Ø·Ø§ Ø¯Ø± Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± ØªÛŒØ± Ù†ÛŒÙ†Ø¬Ø§ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØµÙˆÛŒØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†');
            images.playerBullet.src = ninjaSkin.bullet[1];
        };
        bulletImg.src = ninjaSkin.bullet[0];
    }
    
    // ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø³Ú©ÛŒÙ† Ù†ÛŒÙ†Ø¬Ø§
    document.querySelector('.skin-option[data-skin="ninja"]').addEventListener('click', function() {
        currentSkin = 'ninja';
        loadNinjaSkin();
        
        // Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø§Ø³Ú©ÛŒÙ† Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
        document.querySelectorAll('.skin-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        this.classList.add('selected');
    });
    
    // Ù¾ÛŒØ´â€ŒØ¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµØ§ÙˆÛŒØ± Ù†ÛŒÙ†Ø¬Ø§
    function preloadNinjaImages() {
        const preloadPlayer = new Image();
        preloadPlayer.src = ninjaSkin.player[0];
        
        const preloadBullet = new Image();
        preloadBullet.src = ninjaSkin.bullet[0];
        
        // Ù¾ÛŒØ´â€ŒÙ„ÙˆØ¯ ØªØµØ§ÙˆÛŒØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù‡Ù…
        const preloadBackupPlayer = new Image();
        preloadBackupPlayer.src = ninjaSkin.player[1];
        
        const preloadBackupBullet = new Image();
        preloadBackupBullet.src = ninjaSkin.bullet[1];
    }
    
    // Ø§Ø¬Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒØ¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
    window.addEventListener('load', preloadNinjaImages);
    </script>
    <script>
        // ========== Ú©Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ ==========
        
        // ØªØ§Ø¨Ø¹ ØªØ´Ø®ÛŒØµ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„
        function isMobile() {
          return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
        function optimizeForMobile() {
          if (!isMobile()) return;
        
          // ØªÙ†Ø¸ÛŒÙ… viewport Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø²ÙˆÙ… Ù†Ø§Ø®ÙˆØ§Ø³ØªÙ‡
          const viewportMeta = document.createElement('meta');
          viewportMeta.name = 'viewport';
          viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
          document.head.appendChild(viewportMeta);
        
          // ØªÙ†Ø¸ÛŒÙ… Ø³Ø§ÛŒØ² Ú©Ø§Ù†ÙˆØ§Ø³
          const canvas = document.getElementById('gameCanvas');
          const windowWidth = window.innerWidth;
          const windowHeight = window.innerHeight;
          
          // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø§ Ø­ÙØ¸ Ù†Ø³Ø¨Øª ØªØµÙˆÛŒØ±
          const targetRatio = 16 / 9;
          let canvasWidth, canvasHeight;
          
          if (windowWidth / windowHeight > targetRatio) {
            // Ø­Ø§Ù„Øª Ù„Ù†Ø¯Ø§Ø³Ú©ÛŒÙ¾
            canvasHeight = windowHeight * 0.9;
            canvasWidth = canvasHeight * targetRatio;
          } else {
            // Ø­Ø§Ù„Øª Ù¾Ø±ØªØ±Ù‡
            canvasWidth = windowWidth * 0.95;
            canvasHeight = canvasWidth / targetRatio;
          }
          
          // Ø§Ø¹Ù…Ø§Ù„ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø¬Ø¯ÛŒØ¯
          canvas.width = canvasWidth;
          canvas.height = canvasHeight;
          canvas.style.width = canvasWidth + 'px';
          canvas.style.height = canvasHeight + 'px';
          canvas.style.maxWidth = '100%';
          canvas.style.maxHeight = '90vh';
          canvas.style.margin = '10px auto';
        
          // ØªÙ†Ø¸ÛŒÙ… ÙÙˆÙ†Øª Ùˆ Ø§Ø³ØªØ§ÛŒÙ„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²ÛŒ
          const gameInfo = document.getElementById('gameInfo');
          if (gameInfo) {
            gameInfo.style.width = '95%';
            gameInfo.style.fontSize = '18px';
            gameInfo.style.padding = '10px';
            gameInfo.style.margin = '5px auto';
          }
        
          // ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
          setupMobileControls();
        }
        
        // ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù„Ù…Ø³ÛŒ
        function setupMobileControls() {
          const controls = document.querySelectorAll('.mobile-control');
          controls.forEach(control => {
            control.style.display = 'flex';
          });
        
          // ØªÙ†Ø¸ÛŒÙ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
          const upBtn = document.getElementById('up-btn');
          const downBtn = document.getElementById('down-btn');
          const fireBtn = document.getElementById('fire-btn');
          const enterBtn = document.getElementById('enter-btn');
        
          if (upBtn && downBtn) {
            upBtn.style.bottom = '150px';
            upBtn.style.right = '20px';
            upBtn.style.transform = 'none';
            upBtn.style.width = '80px';
            upBtn.style.height = '80px';
            upBtn.style.fontSize = '30px';
        
            downBtn.style.bottom = '50px';
            downBtn.style.right = '20px';
            downBtn.style.transform = 'none';
            downBtn.style.width = '80px';
            downBtn.style.height = '80px';
            downBtn.style.fontSize = '30px';
          }
        
          if (fireBtn) {
            fireBtn.style.bottom = '100px';
            fireBtn.style.left = '20px';
            fireBtn.style.width = '80px';
            fireBtn.style.height = '80px';
          }
        
          if (enterBtn) {
            enterBtn.style.bottom = '20px';
            enterBtn.style.left = '50%';
            enterBtn.style.transform = 'translateX(-50%)';
            enterBtn.style.width = '150px';
            enterBtn.style.height = '50px';
            enterBtn.style.fontSize = '18px';
          }
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø´Ø¯Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ù¾Ø±ØªØ±Ù‡
        function showPortraitWarning() {
          if (window.innerHeight > window.innerWidth) {
            const warningDiv = document.createElement('div');
            warningDiv.id = 'portraitWarning';
            warningDiv.innerHTML = `
              <div style="
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                color: white;
                text-align: center;
                padding: 20px;
              ">
                <h2>Ø¨Ø±Ø§ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ø¨Ù‡ØªØ±</h2>
                <p>Ù„Ø·ÙØ§Ù‹ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙÙ‚ÛŒ Ø¨Ú†Ø±Ø®Ø§Ù†ÛŒØ¯</p>
                <div style="font-size: 50px; margin: 20px;">â†»</div>
              </div>
            `;
            document.body.appendChild(warningDiv);
          }
        }
        
        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù‡Ø´Ø¯Ø§Ø± Ø­Ø§Ù„Øª Ù¾Ø±ØªØ±Ù‡
        function hidePortraitWarning() {
          const warning = document.getElementById('portraitWarning');
          if (warning) {
            warning.remove();
          }
        }
        
        // Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØºÛŒÛŒØ± Ø³Ø§ÛŒØ² Ù¾Ù†Ø¬Ø±Ù‡
        window.addEventListener('resize', function() {
          optimizeForMobile();
          if (window.innerWidth > window.innerHeight) {
            hidePortraitWarning();
          } else {
            showPortraitWarning();
          }
        });
        
        // Ø§Ø¬Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        window.addEventListener('load', function() {
          optimizeForMobile();
          showPortraitWarning();
          
          // Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
          const style = document.createElement('style');
          style.textContent = `
            @media (max-width: 768px) {
              body {
                overflow: hidden;
                touch-action: manipulation;
                background-color: #000;
              }
              #gameCanvas {
                background-size: contain;
                background-position: center;
              }
              .game-over {
                width: 90% !important;
                padding: 20px !important;
              }
              .game-over h1 {
                font-size: 28px !important;
              }
              .game-over p {
                font-size: 18px !important;
              }
            }
          `;
          document.head.appendChild(style);
        });
        </script>
    <script>
        // ========== Ú©Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ ==========
        
        // 1. Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø­Ø§Ù„Øª Ø¨Ø§Ø²ÛŒ
        let gameInitialized = false;
        let gameRunning = false;
        let currentDifficulty = 'medium'; // Ø³Ø·Ø­ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        
        // 2. ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ø§Ø¨ØªØ¯Ø§
        document.getElementById('gameCanvas').style.display = 'none';
        document.getElementById('gameInfo').style.display = 'none';
        
        // 3. ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ
        function startGameAfterDifficultySelect(difficulty) {
            currentDifficulty = difficulty;
            
            // Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø·Ø­ Ø³Ø®ØªÛŒ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯)
            switch(difficulty) {
                case 'easy':
                    gameState.enemy.speed = 4;
                    gameState.enemy.health = 80;
                    gameState.enemy.shotDelay = 1500;
                    break;
                case 'medium':
                    gameState.enemy.speed = 5;
                    gameState.enemy.health = 100;
                    gameState.enemy.shotDelay = 1200;
                    break;
                case 'hard':
                    gameState.enemy.speed = 6;
                    gameState.enemy.health = 120;
                    gameState.enemy.shotDelay = 900;
                    break;
                case 'devil':
                    gameState.enemy.speed = 7;
                    gameState.enemy.health = 1000;
                    gameState.enemy.shotDelay = 100;
                    break;
            }
        
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ
            gameInitialized = true;
            gameRunning = true;
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
            document.getElementById('gameCanvas').style.display = 'block';
            document.getElementById('gameInfo').style.display = 'block';
            
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
            resetGameState();
            
            console.log('Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ ' + difficulty + ' Ø´Ø±ÙˆØ¹ Ø´Ø¯');
        }
        
        // 4. ØªØ§Ø¨Ø¹ Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
        function resetGameState() {
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
            gameState.player.health = 100;
            gameState.player.bullets = [];
            gameState.player.lastShot = 0;
            
            // Ø±ÛŒØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø¯Ø´Ù…Ù†
            gameState.enemy.health = 100;
            gameState.enemy.bullets = [];
            gameState.enemy.lastShot = 0;
            
            // Ø±ÛŒØ³Øª Ø³Ø§ÛŒØ± ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§
            gameState.gameOver = false;
            gameState.confetti = [];
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ù„Ø§Ù…Øª
            document.getElementById('playerHealth').textContent = '100';
            document.getElementById('enemyHealth').textContent = '100';
            
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
            document.getElementById('gameOver').style.display = 'none';
        }
        
        // 5. ØªØºÛŒÛŒØ± ØªØ§Ø¨Ø¹ gameLoop Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±
        const originalGameLoop = gameLoop;
        gameLoop = function(timestamp) {
            if (gameRunning) {
                originalGameLoop(timestamp);
            } else {
                requestAnimationFrame(gameLoop);
            }
        };
        
        // 6. ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ update Ø¨Ø±Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ø¯Ø± Ù…Ù†ÙˆÙ‡Ø§
        const originalUpdate = update;
        update = function(timestamp) {
            if (gameRunning) {
                originalUpdate(timestamp);
            }
        };
        
        // 7. ØªØºÛŒÛŒØ± Ø¯Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ
        document.getElementById('easyBtn').addEventListener('click', function() {
            startGameAfterDifficultySelect('easy');
        });
        
        document.getElementById('mediumBtn').addEventListener('click', function() {
            startGameAfterDifficultySelect('medium');
        });
        
        document.getElementById('hardBtn').addEventListener('click', function() {
            startGameAfterDifficultySelect('hard');
        });
        
        document.getElementById('comingSoonBtn').addEventListener('click', function() {
            startGameAfterDifficultySelect('devil');
        });
        
        // 8. ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ endGame Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ø¯Ø±Ø³Øª
        const originalEndGame = endGame;
        endGame = function() {
            if (gameRunning) {
                originalEndGame();
            }
        };
        
        // 9. ØªØºÛŒÛŒØ± Ø¯Ø± ØªØ§Ø¨Ø¹ checkCollisions
        const originalCheckCollisions = checkCollisions;
        checkCollisions = function() {
            if (gameRunning) {
                originalCheckCollisions();
            }
        };
        
        // 10. Ø´Ø±ÙˆØ¹ Ø§ÙˆÙ„ÛŒÙ‡
        window.addEventListener('DOMContentLoaded', function() {
            // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ ØªØ§ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ
            gameRunning = false;
            
            // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù…Ø®ÙÛŒ Ø¨ÙˆØ¯Ù† Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
            document.getElementById('gameCanvas').style.display = 'none';
            document.getElementById('gameInfo').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';
            
            // Ø´Ø±ÙˆØ¹ Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ (Ø§Ù…Ø§ ØºÛŒØ±ÙØ¹Ø§Ù„)
            requestAnimationFrame(gameLoop);
            
            console.log('Ù…Ù†ØªØ¸Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ Ø³Ø®ØªÛŒ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø±...');
        });
        </script>
        <script>
            // ======== Ú©Ø¯ ØªØ¶Ù…ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ Ø¨Ø¯ÙˆÙ† Ù‚ÙÙ„ ========
            
            // 1. Ø§Ø¨ØªØ¯Ø§ Ù…Ø·Ù…Ø¦Ù† Ù…ÛŒâ€ŒØ´ÙˆÛŒÙ… Ù…Ù†ÙˆÛŒ Ø³Ø®ØªÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
            const difficultyMenu = document.getElementById('difficultyMenu');
            
            if (difficultyMenu) {
                // 2. Ø­Ø°Ù Ú©Ø§Ù…Ù„ Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ø¯Ú©Ù…Ù‡ Ù‚ÙÙ„ Ø´Ø¯Ù‡ Ù‚Ø¨Ù„ÛŒ
                const oldComingSoonBtn = document.getElementById('comingSoonBtn');
                if (oldComingSoonBtn) {
                    oldComingSoonBtn.remove();
                }
        
                // 3. Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ú©Ù…Ù‡ Ø¬Ø¯ÛŒØ¯ Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ
                const devilBtn = document.createElement('button');
                devilBtn.id = 'devilBtn';
                devilBtn.className = 'difficultyBtn';
                devilBtn.textContent = 'ğŸ‘¹ Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ ğŸ‘¹';
                
                // 4. Ø§Ø³ØªØ§ÛŒÙ„ Ø¯Ù‡ÛŒ Ø¨Ù‡ Ø¯Ú©Ù…Ù‡
                devilBtn.style.background = 'linear-gradient(135deg, #8B0000, #FF0000)';
                devilBtn.style.color = 'white';
                devilBtn.style.border = '2px solid #FF0000';
                devilBtn.style.boxShadow = '0 0 10px #FF0000';
                
                // 5. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø¨Ù‡ Ù…Ù†Ùˆ (Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ú©Ù…Ù‡ Ø³Ø®Øª)
                const hardBtn = document.getElementById('hardBtn');
                if (hardBtn) {
                    hardBtn.after(devilBtn);
                } else {
                    difficultyMenu.appendChild(devilBtn);
                }
                
                // 6. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ
                difficultySettings.devil = {
                    damage: 100,  // Ø¢Ø³ÛŒØ¨ Ø¨Ø³ÛŒØ§Ø± Ø²ÛŒØ§Ø¯
                    speed: 8,     // Ø³Ø±Ø¹Øª Ø¨Ø³ÛŒØ§Ø± Ø¨Ø§Ù„Ø§
                    health: 200,  // Ø³Ù„Ø§Ù…Øª Ø²ÛŒØ§Ø¯ Ø¯Ø´Ù…Ù†
                    shotDelay: 600 // ØªØ§Ø®ÛŒØ± Ú©Ù… Ø¨ÛŒÙ† Ø´Ù„ÛŒÚ©â€ŒÙ‡Ø§
                };
                
                // 7. ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡
                devilBtn.addEventListener('click', function() {
                    startGame('devil');
                });
                
                // 8. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¬Ø§Ù…Ù¾ Ø§Ø³Ú©Ø± Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø®Øª
                const originalEndGame = endGame;
                endGame = function() {
                    if (currentDifficulty === 'devil' && gameState.player.health <= 0) {
                        // Ø§ÛŒØ¬Ø§Ø¯ Ø§ÙÚ©Øª ØªØ±Ø³Ù†Ø§Ú©
                        const jumpScare = document.createElement('div');
                        jumpScare.style.position = 'fixed';
                        jumpScare.style.top = '0';
                        jumpScare.style.left = '0';
                        jumpScare.style.width = '100%';
                        jumpScare.style.height = '100%';
                        jumpScare.style.background = 'black url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSNwPYRGtxal3jn0gkHB0JTtm04XQIFnnsOKw&s") center/cover no-repeat';
                        jumpScare.style.zIndex = '5';
                        jumpScare.style.animation = 'scare 0.3s forwards';
                        
                        document.body.appendChild(jumpScare);
                        
                        // Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ ØªØ±Ø³Ù†Ø§Ú©
                        const scream = new Audio('https://biaupload.com/static/files-2025-04/org-8ae4afc88b3b1.mp3');
                        scream.play();
                        
                        setTimeout(() => {
                            jumpScare.remove();
                            originalEndGame();
                        }, 2000);
                    } else {
                        originalEndGame();
                    }
                };
                
                // 9. Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù…
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes scare {
                        0% { transform: scale(1); opacity: 0; }
                        100% { transform: scale(1.1); opacity: 1; }
                    }
                    #devilBtn:hover {
                        transform: scale(1.05);
                        box-shadow: 0 0 20px #FF0000;
                    }
                `;
                document.head.appendChild(style);
                
                console.log('Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙØ¹Ø§Ù„ Ø´Ø¯!');
            } else {
                console.error('Ù…Ù†ÙˆÛŒ Ø³Ø®ØªÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯!');
            }
        </script>
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø§Ø²ÛŒ Ø¨Ø§ Ø³Ø·Ø­ Ø´ÛŒØ·Ø§Ù†ÛŒ</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ */
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #111;
            color: white;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: red;
            border-radius: 50%;
            transition: transform 0.1s;
        }
        
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
        }
        
        /* Ù…Ù†ÙˆÛŒ Ø¯Ø´ÙˆØ§Ø±ÛŒ */
        #difficultyMenu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }